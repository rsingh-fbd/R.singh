<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Live Stream Player â€” Fullscreen Mode</title>
  <style>
    html,body { margin:0; height:100%; background:#000; overflow:hidden; }
    body { display:flex; align-items:center; justify-content:center; }
    .player-wrap { position:relative; width:100%; height:100%; background:#000; }
    video { width:100%; height:100%; object-fit:contain; background:#000; }

    /* Overlay UI */
    .ui{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:space-between;opacity:0;transition:opacity .25s;pointer-events:none;z-index:25}
    .ui.show{opacity:1;pointer-events:auto}
    .ui .topbar{display:flex;justify-content:center;margin-top:12px}
    .chip{background:rgba(0,0,0,.55);color:#fff;padding:6px 14px;border-radius:999px;font-size:14px;backdrop-filter:saturate(120%) blur(2px)}
    .ui .mid{display:flex;justify-content:space-between;align-items:center;padding:0 56px}
    .round{width:44px;height:44px;border-radius:50%;background:rgba(0,0,0,.55);color:#fff;display:flex;align-items:center;justify-content:center;font-size:22px;cursor:pointer;user-select:none}
    .ui .bot{display:flex;justify-content:space-between;align-items:center;padding:10px}
    .counter{font-size:12px;color:#aaa}

    .vol{display:flex;align-items:center;gap:8px;background:rgba(0,0,0,.55);padding:6px 10px;border-radius:999px}
    .vol input[type="range"]{width:0;transition:width .25s;accent-color:#4da3ff}
    .ui.show .vol input[type="range"], .vol:hover input[type="range"]{width:120px}
    .vol-btn{cursor:pointer}

    .hamburger{position:absolute;top:50%;left:10px;transform:translateY(-50%);width:40px;height:40px;border-radius:50%;background:#4da3ff;color:#001028;display:flex;align-items:center;justify-content:center;font-weight:800;cursor:pointer;z-index:32}

    .chan-overlay{position:absolute;top:0;left:0;bottom:0;width:320px;max-width:85%;background:rgba(18,25,54,.96);border-radius:0 12px 12px 0;transform:translateX(-100%);transition:.28s ease;z-index:30;display:flex;flex-direction:column;gap:10px;padding:12px}
    .chan-overlay.active{transform:translateX(0)}
    .search{padding:8px 10px;border-radius:8px;border:1px solid #2a355e;background:#0e1533;color:#fff;outline:none}
    .list{overflow:auto;flex:1}
    .item{display:flex;align-items:center;gap:10px;padding:10px 12px;background:#1b2447;border-bottom:1px solid #2a355e;cursor:pointer}
    .item:hover{background:#2c386d}
    .item.active{background:#4da3ff;color:#001028;font-weight:600}
    .logo{width:28px;height:28px;border-radius:6px;object-fit:contain;background:#000}

    .toast{position:absolute;left:14px;bottom:14px;background:rgba(0,0,0,.55);border-radius:12px;padding:8px 12px;display:flex;align-items:center;gap:10px;opacity:0;transform:translateY(10px);transition:.25s;z-index:26}
    .toast.show{opacity:1;transform:translateY(0)}
    .toast .tlogo{width:26px;height:26px;border-radius:6px;object-fit:contain;background:#000}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8/dist/hls.min.js"></script>
</head>
<body>
  <div class="player-wrap" id="wrap">
    <video id="video" playsinline></video>
    <div class="ui" id="ui">
      <div class="topbar"><div class="chip" id="title">â€”</div></div>
      <div class="mid">
        <div class="round" id="prev" title="Previous">âŸ¨</div>
        <div class="round" id="next" title="Next">âŸ©</div>
      </div>
      <div class="bot">
        <div class="counter" id="counter"></div>
        <div class="vol" id="vol">
          <span class="vol-btn" id="muteBtn">ðŸ”Š</span>
          <input type="range" id="volRange" min="0" max="1" step="0.01" value="1" />
        </div>
      </div>
    </div>
    <div class="hamburger" id="toggle" title="Channels">â˜°</div>
    <aside class="chan-overlay" id="overlay">
      <input id="search" class="search" placeholder="Search channels..." />
      <div id="channels" class="list"></div>
    </aside>
    <div class="toast" id="toast">
      <img class="tlogo" id="toastLogo" alt="" />
      <div id="toastText">Now Playing</div>
    </div>
  </div>

<script>
const PLAYLIST = "https://raw.githubusercontent.com/rsingh-fbd/R.singh/main/Playlist.m3u";
const video = document.getElementById('video');
const ui = document.getElementById('ui');
const titleChip = document.getElementById('title');
const counter = document.getElementById('counter');
const prevBtn = document.getElementById('prev');
const nextBtn = document.getElementById('next');
const volRange = document.getElementById('volRange');
const muteBtn = document.getElementById('muteBtn');
const overlay = document.getElementById('overlay');
const toggleBtn = document.getElementById('toggle');
const channelsEl = document.getElementById('channels');
const searchEl = document.getElementById('search');
const toast = document.getElementById('toast');
const toastLogo = document.getElementById('toastLogo');
const toastText = document.getElementById('toastText');

let channels = [], currentIndex = 0, hls = null, uiTimer=null, toastTimer=null;

// Fullscreen helper
function enterFullscreen(){ document.getElementById('wrap').requestFullscreen?.(); }

// Load playlist
async function loadPlaylist(){
  const res = await fetch(PLAYLIST);
  const text = await res.text();
  channels = parseM3U(text);
  renderChannels(channels);
  selectChannel(0);
}
function parseM3U(txt){
  const lines = txt.split(/\\r?\\n/);
  const out=[]; let meta={name:'',logo:''};
  for(const raw of lines){
    const line=raw.trim(); if(!line) continue;
    if(line.startsWith('#EXTINF')){
      const n=/(?:tvg-name=\"([^\"]+)\")/.exec(line); const l=/(?:tvg-logo=\"([^\"]+)\")/.exec(line);
      const after=/(?:,(.*)$)/.exec(line);
      meta.name=(n&&n[1])||(after&&after[1].trim())||'Channel'; meta.logo=l?l[1]:'';
    } else if(!line.startsWith('#')){ out.push({name:meta.name,url:line,logo:meta.logo}); meta={name:'',logo:''}; }
  }
  return out;
}
function renderChannels(list){
  channelsEl.innerHTML='';
  list.forEach((ch,i)=>{
    const div=document.createElement('div'); div.className='item';
    div.innerHTML=`<img class=\"logo\" src=\"${ch.logo||''}\" onerror=\"this.style.visibility='hidden'\"> <div>${ch.name}</div>`;
    div.onclick=()=>{ selectChannel(i); closeOverlay(); };
    channelsEl.appendChild(div);
  });
}
function selectChannel(i){
  if(i<0||i>=channels.length) return; currentIndex=i;
  const ch=channels[i]; playStream(ch.url); showTitle(ch.name); showToast(ch.name,ch.logo);
  updateCounter();
}
function playStream(url){
  if(hls){hls.destroy(); hls=null;}
  if(video.canPlayType('application/vnd.apple.mpegurl')){ video.src=url; video.play(); }
  else if(Hls.isSupported()){ hls=new Hls(); hls.loadSource(url); hls.attachMedia(video); hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play()); }
}
function showTitle(n){ titleChip.textContent=n; flashUI(); }
function updateCounter(){ counter.textContent=`Channel ${currentIndex+1}/${channels.length}`; }

function flashUI(){ ui.classList.add('show'); clearTimeout(uiTimer); uiTimer=setTimeout(()=>ui.classList.remove('show'),3000); }
['mousemove','click','touchstart','keydown'].forEach(ev=>document.addEventListener(ev,flashUI,{passive:true}));

// Volume
function setVolume(v){ video.volume=Math.max(0,Math.min(1,v)); volRange.value=video.volume; muteBtn.textContent=video.volume===0?'ðŸ”‡':'ðŸ”Š'; flashUI(); }
volRange.oninput=()=>setVolume(parseFloat(volRange.value)); muteBtn.onclick=()=>{video.muted=!video.muted; muteBtn.textContent=video.muted?'ðŸ”‡':'ðŸ”Š';};

// Next/Prev
prevBtn.onclick=()=>selectChannel((currentIndex-1+channels.length)%channels.length);
nextBtn.onclick=()=>selectChannel((currentIndex+1)%channels.length);

// Overlay
toggleBtn.onclick=()=>overlay.classList.toggle('active');
function closeOverlay(){ overlay.classList.remove('active'); }

// Toast
function showToast(name,logo){ toastText.textContent=name; if(logo){toastLogo.src=logo;toastLogo.style.visibility='visible';}else{toastLogo.style.visibility='hidden';} toast.classList.add('show'); clearTimeout(toastTimer); toastTimer=setTimeout(()=>toast.classList.remove('show'),3000); }

// Keyboard
document.addEventListener('keydown',e=>{const k=e.key.toLowerCase(); if(k==='f')enterFullscreen(); if(k==='n')nextBtn.click(); if(k==='p')prevBtn.click();});

// Auto fullscreen
video.addEventListener('play', enterFullscreen);

// Init
loadPlaylist();
</script>
</body>
</html>