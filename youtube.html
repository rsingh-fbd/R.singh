<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>YouTube Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background: black;
    overflow: hidden;
}

/* Wrapper that covers screen */
#player-wrapper {
    position: fixed;
    inset: 0;
    background: black;
    overflow: hidden;
}

/* Force YouTube iframe to COVER screen */
#player-wrapper iframe {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100vw;
    height: 100vh;
    transform: translate(-50%, -50%);
    border: 0;
}

/* Landscape handling (TV / Android box) */
@media (min-aspect-ratio: 16/9) {
    #player-wrapper iframe {
        height: 56.25vw; /* 9/16 */
    }
}

/* Portrait handling (mobile) */
@media (max-aspect-ratio: 16/9) {
    #player-wrapper iframe {
        width: 177.78vh; /* 16/9 */
    }
}
</style>
</head>

<body>

<div id="player-wrapper"></div>

<script>
const DEFAULT_CONFIG = {
    url: "",
    autoplay: 1,
    mute: 1,
    controls: 1,
    loop: 0,
    rel: 0,
    start: 0
};

const JSON_FILE = "files/video.json";
const DEFAULT_VIDEO_ID = "dQw4w9WgXcQ";

function getYouTubeId(url) {
    if (!url) return DEFAULT_VIDEO_ID;

    let m;
    if ((m = url.match(/youtu\.be\/([a-zA-Z0-9_-]+)/))) return m[1];
    if ((m = url.match(/[?&]v=([a-zA-Z0-9_-]+)/))) return m[1];

    return DEFAULT_VIDEO_ID;
}

function buildEmbedUrl(videoId, cfg) {
    const p = new URLSearchParams({
        autoplay: Number(cfg.autoplay),
        mute: Number(cfg.mute),
        controls: Number(cfg.controls),
        rel: Number(cfg.rel),
        start: Number(cfg.start),
        playsinline: 1
    });

    if (Number(cfg.loop) === 1) {
        p.append("loop", "1");
        p.append("playlist", videoId);
    }

    return `https://www.youtube.com/embed/${videoId}?${p.toString()}`;
}

fetch(JSON_FILE)
    .then(r => r.json())
    .then(cfg => {
        cfg = Object.assign({}, DEFAULT_CONFIG, cfg);

        const videoId = getYouTubeId(cfg.url);
        const embedUrl = buildEmbedUrl(videoId, cfg);

        document.getElementById("player-wrapper").innerHTML = `
            <iframe
                src="${embedUrl}"
                allow="autoplay; encrypted-media; fullscreen"
                allowfullscreen>
            </iframe>
        `;
    })
    .catch(() => {
        document.body.innerHTML =
            "<h2 style='color:white;text-align:center'>video.json load failed</h2>";
    });
</script>

</body>
</html>